<html layout:decorate="layouts/layout">
<div layout:fragment="content">
    <script>
        var errorMessage = "[[${cartOrderErrorMessage}]]";

        if(errorMessage) {
            alert(errorMessage)
        }
    </script>

<!--    <ul style="display:flex; flex-direction: column; align-items:center; margin-top: 50px;">-->
<!--        <li th:each="cart : ${cartList}">-->
<!--            <th:block th:with="product = ${cart.product}">-->
<!--                <div class="card-body" style="font-size: 15px">-->
<!--                    <h2 class="card-title">-->
<!--                        <span th:text="${product.name}"></span>-->
<!--                    </h2>-->
<!--                    <div class="flex items-center">-->
<!--                        <div>-->
<!--                            <img th:src="${product.image}" style="width: 100px; height: 100px">-->
<!--                        </div>-->

<!--                        <div class="flex items-center">-->
<!--                            <span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}"></span>-->
<!--                            <span>원</span>-->
<!--                            <form th:action="|/cart/${product.productId}|" method="POST">-->
<!--                                <input type="hidden" name="_method" value="DELETE">-->
<!--                                <button type="submit" class="btn btn-primary" style="color: #000000">삭제</button>-->
<!--                            </form>-->
<!--                        </div>-->
<!--                    </div>-->


<!--                </div>-->
<!--            </th:block>-->
<!--        </li>-->

<!--        <div class="flex flex-col justify-center mt-3">-->
<!--            <span>총액 : <span th:text="${#numbers.formatDecimal(cartProductTotalPrice, 0, 'COMMA', 0, 'POINT')}"></span>원</span>-->
<!--            <form th:action="@{/order/orderProductFromCart}" method="POST">-->
<!--                <button type="submit" class="btn btn-primary" style="color: #000000">전체 주문</button>-->
<!--            </form>-->
<!--        </div>-->
<!--    </ul>-->




    <div style="display:flex; flex-direction: column; align-items:center; margin-top: 50px;">
        <div style="margin-top: 20px;">
            <div style="display: flex; align-items:center; font-size: 15px; margin-bottom: 5px;">
                <img style="width: 20px; height: 15px; margin-right: 3px;" th:src="@{/images/cart.png}"> 장바구니
            </div>
            <table class="table" style="width: 900px; margin-bottom: 10px;">
                <thead style="border-top: 1px solid black; border-bottom: 1px solid black; font-size: 16px;">
                <tr style="text-align: center;">
                    <th style="width: 10%;">NO</th>
<!--                    <th style="width: 10%;">-->
<!--                        <input id="check-all" class="input-fill" type="checkbox" onclick="toggleAllAgreements()">-->
<!--                    </th>-->
                    <th style="width: 30%;">상품명(옵션)</th>
                    <th style="width: 15%;">판매가</th>
<!--                    <th style="width: 15%;">수량</th>-->
                    <th style="width: 20%;" colspan="2">주문관리</th>
                </tr>
                </thead>

                <tbody style="font-size: 13px; line-height: 50px;" class="select-all">
                <tr th:each="cart, iterStat : ${cartList}" style="text-align: center;">
                    <th:block th:with="product = ${cart.product}">
                        <td style="width: 10%;">
                            <div th:text="${iterStat.count}">1</div>
                        </td>
<!--                        <td style="width: 10%;">-->
<!--                            <div>-->
<!--                                <input id="check-all" class="inpu-fill" type="checkbox">-->
<!--                            </div>-->
<!--                        </td>-->
                        <td style="width: 30%;">
                            <div style="display: flex; justify-content: center;">
                                <img style="width: 45px; height: 45px;" th:src="${product.image}">
                                <div style="display: flex; flex-direction: column;">
                                    <div style="margin-left: 10px; height: 25px; display: flex; flex-direction:column; justify-content: center;">
                                        <span th:text="${product.name.length() > 21 ? product.name.substring(0, 21) + '...' : product.name}">상품명</span>
                                    </div>
                                    <div style="margin-left: 10px; height: 25px; display: flex; flex-direction:column; justify-content: center;">
                                        <span>상품옵션</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="width: 15%;">
                            <span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}"></span>
<!--                            <div>(금액*수량)</div>-->
                        </td>

<!--                        <td style="width: 15%;">-->
<!--                            <div style="display:flex; justify-content: center; " class="updown">-->
<!--                                <input type='button' onclick='count("minus", 1)' value='-'/> &lt;!&ndash; 각 상품에 대한 고유한 ID를 전달 &ndash;&gt;-->
<!--                                <div style="width: fit-content; margin: 0 7px 0 7px;" id='result_1' class='result'>0</div>-->
<!--                                &lt;!&ndash; 각 상품에 대한 고유한 ID를 부여 &ndash;&gt;-->
<!--                                <input type='button' onclick='count("plus", 1)' value='+'/> &lt;!&ndash; 각 상품에 대한 고유한 ID를 전달 &ndash;&gt;-->
<!--                            </div>-->
<!--                        </td>-->
                        <td style="width: 20%;" colspan="2">
                            <!-- Button trigger modal -->
<!--                            <button type="button" class="btn btn-outline-dark" style="font-size: 13px;" data-bs-toggle="modal"-->
<!--                                    data-bs-target="#1" onclick="option(1)">옵션-->
<!--                            </button>-->
                            <!-- Modal -->
<!--                            <div class="modal fade" id="1" data-bs-backdrop="static" data-bs-keyboard="false"-->
<!--                                 tabindex="-1" aria-labelledby="1" aria-hidden="true">-->
<!--                                <div class="modal-dialog">-->
<!--                                    <div class="modal-content">-->
<!--                                        <div class="modal-header">-->
<!--                                            <h1 class="modal-title fs-5" id="staticBackdropLabel">옵션</h1>-->
<!--                                        </div>-->
<!--                                        <div class="modal-body">-->
<!--                                            <select class="form-select form-select-lg mb-3" aria-label="Large select example">-->
<!--                                                <option selected>옵션 선택</option>-->
<!--                                                <option value="1">One</option>-->
<!--                                                <option value="2">Two</option>-->
<!--                                                <option value="3">Three</option>-->
<!--                                            </select>-->
<!--                                        </div>-->
<!--                                        <div class="modal-footer">-->
<!--                                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">닫기-->
<!--                                            </button>-->
<!--                                            <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">변경</button>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->

                            <form th:action="|/cart/${product.productId}|" method="POST">
                                <input type="hidden" name="_method" value="DELETE">
                                <button type="submit" class="btn btn-outline-danger" style="margin-left: 5px; font-size: 13px;">삭제</button>
                            </form>

<!--                            <button class="btn btn-outline-danger" style="margin-left: 5px; font-size: 13px;">삭제</button>-->

                        </td>
                    </th:block>


                </tr>
                </tbody>
            </table>
<!--            <div style="margin-bottom: 5px; text-align: end;">-->
<!--                <button class="btn btn-outline-secondary" style="font-size: 13px;">선택 삭제</button>-->
<!--            </div>-->
            <div style="margin-bottom: 30px; text-align: end; font-size: 20px; font-weight: bold; color: blue;"><i
                    class="fa-solid fa-won-sign"></i>
                <span>총액 : <span th:text="${#numbers.formatDecimal(cartProductTotalPrice, 0, 'COMMA', 0, 'POINT')}"></span>원</span>
            </div>
            <div style="margin-bottom: 50px; text-align: center;">
                <form class="btn btn-dark" th:action="@{/order/orderProductFromCart}" method="POST">
                    <button type="submit" class="btn btn-dark" style="width:180px; height:50px; border-radius:10px; font-size: 25px;">주 문 하 기</button>
                </form>

<!--                <button class="btn btn-dark" style="width:180px; height:50px; border-radius:10px; font-size: 25px;">주 문-->
<!--                    하 기-->
<!--                </button>-->
            </div>
        </div>
    </div>
</div>
<div layout:fragment="script">
    <script th:inline="javascript">
        /*<![CDATA[*/
        function toggleAllAgreements() {
            var checkAll = document.getElementById('check-all');
            var agreements = document.querySelectorAll('.select-all input[type="checkbox"]');

            for (var i = 0; i < agreements.length; i++) {
                agreements[i].checked = checkAll.checked;
            }
        }

        /*]]>*/
    </script>
    <script>
        function count(type, productId) {
            // 결과를 표시할 element
            const resultElement = document.getElementById(`result_${productId}`);

            // 현재 화면에 표시된 값
            let number = parseInt(resultElement.innerText);

            // 더하기/빼기
            if (type === 'plus') {
                number = parseInt(number) + 1;
            } else if (type === 'minus' && number > 0) {
                number = parseInt(number) - 1;
            }

            // 결과 출력
            resultElement.innerText = number;
        }

    </script>

    <!--    <script>-->
    <!--        // 첫 번째 상품 모달을 위한 스크립트-->
    <!--        const modal1 = new bootstrap.Modal(document.getElementById('staticBackdrop1'));-->

    <!--        document.getElementById('optionButton1').addEventListener('click', () => {-->
    <!--            modal1.show();-->
    <!--        });-->

    <!--        // 두 번째 상품 모달을 위한 스크립트-->
    <!--        const modal2 = new bootstrap.Modal(document.getElementById('staticBackdrop2'));-->

    <!--        document.getElementById('optionButton2').addEventListener('click', () => {-->
    <!--            modal2.show();-->
    <!--        });-->
    <!--    </script>-->
    <script>
        function option(productId){
        const myModal = new bootstrap.Modal(document.getElementById(`${productId}`), options)
        }
    </script>
    <div style="height: 500px;"></div>
</div>
</html>